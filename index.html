<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Foiling NYC Cabs</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Big Querying the Medallions</h1>
        <p></p>

        <p class="view"><a href="https://github.com/jumpypotato/foiling_nyc_cabs">View the Project on GitHub <small>jumpypotato/foiling_nyc_cabs</small></a></p>
      </header>
      <section>
        <h3>
<a id="background" class="anchor" href="#background" aria-hidden="true"><span class="octicon octicon-link"></span></a>Background</h3>

<p> With the <a href="https://en.wikipedia.org/wiki/Legal_status_of_Uber%27s_service">hype</a> around the legality of Uber in many of the cities that it operates in, it makes all the sense to find out more about the people most affected by this disruptive force; the licensed taxi operators.

<br><br>

If you love data (and lots of it), you're in for a real treat! </p>

<h3>
<a id="show-me-the-data" class="anchor" href="#show-me-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Show Me The Data
</h3>

<p>Traditionally, one would have to conduct laborous surveys, one taxi operator at a time. The data was initially retrieved by Chris Whong, a data visualization analyst, through a FOIL (Freedom of Information Law) request. In its entirety, it comes in at a whopping 18.7gb compressed.

<br><br>

Fortunately, the internet is full of amazing people and the dataset met Google engineer Jason Hall. It now lives happily as a <a href="https://bigquery.cloud.google.com/table/imjasonh-storage:nyctaxi.trip_fare">Google Big Query project</a>.
</p>

<h3>
<a id="think-big" class="anchor" href="#think-big" aria-hidden="true"><span class="octicon octicon-link"></span></a>Think Big</h3>

<p>Ideally, we should first come up with a set of hypotheses before delving into data collection/analysis. This is to decrease the likelihood that we frame the problem in a way that is overly limiting. Our case here is a little special as the data has already been creative. However, we should not let this luxury stifle our ability to get creative and imaginative about our analysis.
<br><br>
The data is stored in two tables; trip_data and trip_fare.

<br>

<table class="tg">
  <col style="width:30%">
  <col style="width:40%">
  <col style="width:30%">
  <tr>
    <th class="tg-hgcj" colspan="3">trip_data</th>
  </tr>
  <tr>
    <th class="tg-yw4l">Attribute</th>
    <th class="tg-yw4l">Description</th>
    <th class="tg-yw4l">Range and Basic Statistics</th>
  </tr>
  <tr>
    <td class="tg-b7b8">medallion</td>
    <td class="tg-b7b8">Output of applying an MD5 hash on the unique alphanumeric code assigned to each cab.</td>
    <td class="tg-b7b8">N/A</td>
  </tr>
  <tr>
    <td class="tg-yw4l">hack_license</td>
    <td class="tg-yw4l">Output of applying an MD5 hash on the unique alphanumeric code assigned to each cab driver.</td>
    <td class="tg-yw4l">N/A</td>
  </tr>
  <tr>
    <td class="tg-b7b8">vendor_id</td>
    <td class="tg-b7b8">The vendor assigned to perform the Taxicab Passenger Enhancements Project (TPEP). VTS refers to work performed by Verifone Transportation Systems while CMT is for work by Mobile Knowledge Systems Inc.</td>
    <td class="tg-b7b8">N/A</td>
  </tr>
  <tr>
    <td class="tg-yw4l">rate_code</td>
    <td class="tg-yw4l">Taximeter rate. </td>
    <td class="tg-yw4l"></td>
  </tr>
  <tr>
    <td class="tg-b7b8">store_and_fwd_flag</td>
    <td class="tg-b7b8">Unknown attribute.</td>
    <td class="tg-b7b8"></td>
  </tr>
  <tr>
    <td class="tg-yw4l">pickup_datetime</td>
    <td class="tg-yw4l">Start timestamp of the trip. Presented in the format mm-dd-yyyy hh24:mm:ss.</td>
    <td class="tg-yw4l"></td>
  </tr>
  <tr>
    <td class="tg-b7b8">dropoff_datetime</td>
    <td class="tg-b7b8">End timestamp of the trip. Presented in the format mm-dd-yyyy hh24:mm:ss.</td>
    <td class="tg-b7b8"></td>
  </tr>
  <tr>
    <td class="tg-yw4l">passenger_count</td>
    <td class="tg-yw4l">Number of passengers on the trip. Default value is 1.</td>
    <td class="tg-yw4l">0 to 255</td>
  </tr>
  <tr>
    <td class="tg-b7b8">trip_time_in_secs</td>
    <td class="tg-b7b8">Trip time measured by the taximeter, in seconds.</td>
    <td class="tg-b7b8">-6480 to 4294966</td>
  </tr>
  <tr>
    <td class="tg-yw4l">trip_distance</td>
    <td class="tg-yw4l">Trip distance measured by the taximeter, in meters.</td>
    <td class="tg-yw4l">0 to 15331800<br></td>
  </tr>
  <tr>
    <td class="tg-b7b8">pickup_longitude</td>
    <td class="tg-b7b8">GPS longtitude coordinate of the pickup location.</td>
    <td class="tg-b7b8">-0.000002 to 98.158493</td>
  </tr>
  <tr>
    <td class="tg-yw4l">pickup_latitude</td>
    <td class="tg-yw4l">GPS latitude coordinate of the pickup location.</td>
    <td class="tg-yw4l">-0.000002 to 96.685364</td>
  </tr>
  <tr>
    <td class="tg-b7b8">dropoff_longitude</td>
    <td class="tg-b7b8">GPS longitude coordinate of the drop off location.</td>
    <td class="tg-b7b8">-0.000002 to 98.158493</td>
  </tr>
  <tr>
    <td class="tg-yw4l">dropoff_latitude</td>
    <td class="tg-yw4l">GPS latitude coordinate of the drop off location.</td>
    <td class="tg-yw4l">-0.000008 to 948.20953</td>
  </tr>
</table>

<table class="tg">
  <col style="width:30%">
  <col style="width:40%">
  <col style="width:30%">
  <tr>
    <th class="tg-hgcj" colspan="3">trip_fare</th>
  </tr>
  <tr>
    <th class="tg-e3zv">Attribute</th>
    <th class="tg-e3zv">Description</th>
    <th class="tg-e3zv">Range and Basic Statistics</th>
  </tr>
  <tr>
    <td class="tg-031e">medallion</td>
    <td class="tg-031e">Output of applying an MD5 hash on the unique alphanumeric code assigned to each cab.</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">hack_license</td>
    <td class="tg-031e">Output of applying an MD5 hash on the unique alphanumeric code assigned to each cab driver.</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">vendor_id</td>
    <td class="tg-031e">The vendor assigned to perform the Taxicab Passenger Enhancements Project (TPEP). VTS refers to work performed by Verifone Transportation Systems while CMT is for work by Mobile Knowledge Systems Inc.</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">pickup_datetime</td>
    <td class="tg-031e"></td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">payment_type</td>
    <td class="tg-031e">CSH: Cash<br>CRD: Credit Card<br>NOC:<br>DIS: <br>UNK: Unknown</td>
    <td class="tg-031e"></td>
  </tr>
  <tr>
    <td class="tg-031e">fare_amount</td>
    <td class="tg-031e">The meter fare, in USD.</td>
    <td class="tg-031e">-0.01 to 999.99</td>
  </tr>
  <tr>
    <td class="tg-031e">surcharge</td>
    <td class="tg-031e">Extra fees, such as rush hour and overnight surcharges, in USD.</td>
    <td class="tg-031e">9.8 to 999.99</td>
  </tr>
  <tr>
    <td class="tg-031e">mta_tax</td>
    <td class="tg-031e">Metropolitan commuter transportation mobility tax, in USD.</td>
    <td class="tg-031e">-0.5 to 9</td>
  </tr>
  <tr>
    <td class="tg-031e">tip_amount</td>
    <td class="tg-031e">Tip amount, in USD.</td>
    <td class="tg-031e">-0.05 to 99.99</td>
  </tr>
  <tr>
    <td class="tg-031e">tolls_amount</td>
    <td class="tg-031e">Total price paid for tolls, summed across all tolls for the trip, in USD.</td>
    <td class="tg-031e">-1.5 to 99</td>
  </tr>
  <tr>
    <td class="tg-031e">total_amount</td>
    <td class="tg-031e">Total charges presented to the passenger at time of fare payment (includes tip for non-cash trips), in USD.</td>
    <td class="tg-031e">-0.01 to 999.99</td>
  </tr>
</table>

In total, data from 173,179,759[1] trips in the year 2013[2]

</p>

<h3>
<a id="cleaning-the-medallions" class="anchor" href="#cleaning-the-medallions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cleaning the Medallions
</h3>

<p>
Those with a keen sense of observation should by now realize that there is something funky is going on with some of the data. 
<br><br>
For example, having a range of 0 to 255 for passenger count certainly looks fishy. Last I checked, it is pretty difficult to get that many people into a car, and having 0 passengers sounds a lot like the plot of the next blockbuster horror. Let's proceed field by field to squash all these errors.
</p>

<h4>
<a id="passenger_count" class="anchor" href="#passenger_count" aria-hidden="true"><span class="octicon octicon-link"></span></a>i. passenger_count
</h4>

<p>
<table class="tg">
  <tr>
    <th class="tg-yw4l">passenger_count</th>
    <th class="tg-yw4l">count</th>
  </tr>
  <tr>
    <td class="tg-yw4l">0</td>
    <td class="tg-yw4l">5035</td>
  </tr>
  <tr>
    <td class="tg-yw4l">1</td>
    <td class="tg-yw4l">121959711</td>
  </tr>
  <tr>
    <td class="tg-yw4l">2</td>
    <td class="tg-yw4l">23517494</td>
  </tr>
  <tr>
    <td class="tg-yw4l">3</td>
    <td class="tg-yw4l">7315829</td>
  </tr>
  <tr>
    <td class="tg-yw4l">4</td>
    <td class="tg-yw4l">3582103</td>
  </tr>
  <tr>
    <td class="tg-yw4l">5</td>
    <td class="tg-yw4l">10034696</td>
  </tr>
  <tr>
    <td class="tg-yw4l">6</td>
    <td class="tg-yw4l">6764789</td>
  </tr>
  <tr>
    <td class="tg-yw4l">7</td>
    <td class="tg-yw4l">35</td>
  </tr>
  <tr>
    <td class="tg-yw4l">8</td>
    <td class="tg-yw4l">25</td>
  </tr>
  <tr>
    <td class="tg-yw4l">9</td>
    <td class="tg-yw4l">26</td>
  </tr>
  <tr>
    <td class="tg-yw4l">129</td>
    <td class="tg-yw4l">1</td>
  </tr>
  <tr>
    <td class="tg-yw4l">208</td>
    <td class="tg-yw4l">13</td>
  </tr>
  <tr>
    <td class="tg-yw4l">255</td>
    <td class="tg-yw4l">2</td>
  </tr>
</table>

A quick check with the <a href="http://www.nyc.gov/html/tlc/html/faq/faq_pass.shtml#3">NYC Taxi & Limousine Commission</a> reveals that the maximum legal number of passengers in a medallion is 4. 
<br><br>
Therefore, it is pretty amusing to see the high instances of extreme honesty from medallion drivers with 5 or 6 passengers, or maybe its simply a case of <a href="https://en.wikipedia.org/wiki/Typographical_error">fat finger syndrome</a>? As we are uncertain of the mechanism of how this field is captured, we shall set the error-free limits of this field to be between 1 and 6, ends inclusive.

</p>

<p>
<h4>
<a id="trip_time_in_secs" class="anchor" href="#trip_time_in_secs" aria-hidden="true"><span class="octicon octicon-link"></span></a>ii. trip_time_in_secs
</h4>

New
</p>

<h3>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credits
</h3>

<p> <a href="http://chriswhong.com">Chris Whong - For invoking FOIL (The Freedom of Information Law) to retrieve this amazing dataset.</a> </p>

<h3>
<a id="appendix" class="anchor" href="#appendix" aria-hidden="true"><span class="octicon octicon-link"></span></a>Appendix</h3>

<p>

</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/jumpypotato">jumpypotato</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
